var ulp_active_window_id=false;var ulp_subscribing=false;var ulp_onexit_displayed=false;var ulp_timeout;function ulp_open(id){return _ulp_open(id,true);}
function _ulp_open(id,main_window){clearTimeout(ulp_timeout);jQuery("#ulp-"+id).each(function(){ulp_active_window_id=id;if(main_window){jQuery("#ulp-"+id+"-overlay").fadeIn(300);if(jQuery(this).attr("data-close")=="on"){jQuery("#ulp-"+id+"-overlay").bind("click",function($){ulp_close(id);});}}
var viewport={width:Math.max(320,jQuery(window).width()),height:Math.max(320,jQuery(window).height())};var width=parseInt(jQuery(this).attr("data-width"),10);var height=parseInt(jQuery(this).attr("data-height"),10);var scale=Math.min((viewport.width-20)/width,viewport.height/height);if(scale>1)scale=1;width=parseInt(width*scale,10);height=parseInt(height*scale,10);jQuery(this).css({"width":width+"px","height":height+"px","margin-left":"-"+parseInt(width/2,10)+"px","margin-top":"-"+parseInt(height/2,10)+"px"});var content=jQuery(this).find(".ulp-content");jQuery(content).css({"width":width+"px","height":height+"px",});jQuery(content).find(".ulp-layer").each(function(){var layer=this;var confirmation_layer=jQuery(layer).attr("data-confirmation");if(confirmation_layer=="on"&&main_window){jQuery(layer).hide();return;}else if(confirmation_layer=="off"&&!main_window){return;}
jQuery(layer).show();var layer_content_encoded=jQuery(layer).attr("data-base64");if(layer_content_encoded){jQuery(layer).html(ulp_decode64(jQuery(layer).html()));}
var layer_left=jQuery(layer).attr("data-left");var layer_top=jQuery(layer).attr("data-top");var layer_width=jQuery(layer).attr("data-width");var layer_height=jQuery(layer).attr("data-height");var layer_font_size=jQuery(layer).attr("data-font-size");var layer_appearance=jQuery(layer).attr("data-appearance");var layer_appearance_delay=parseInt(jQuery(layer).attr("data-appearance-delay"),10);var layer_appearance_speed=parseInt(jQuery(layer).attr("data-appearance-speed"),10);if(layer_width)jQuery(layer).css("width",parseInt(layer_width*scale,10)+"px");if(layer_height){jQuery(layer).css("height",parseInt(layer_height*scale,10)+"px");var layer_scrollbar=jQuery(layer).attr("data-scrollbar");if(layer_scrollbar&&layer_scrollbar=="on"){jQuery(layer).css("overflow","hidden");jQuery(layer).scrollTop(0);jQuery(layer).perfectScrollbar({suppressScrollX:true});}}
if(layer_font_size)jQuery(layer).css("font-size",Math.max(4,parseInt(layer_font_size*scale,10))+"px");switch(layer_appearance){case "slide-down":jQuery(layer).css({"left":parseInt(layer_left*scale,10)+"px","top":"-"+parseInt(2*viewport.height)+"px"});setTimeout(function(){jQuery(layer).animate({"top":parseInt(layer_top*scale,10)+"px"},layer_appearance_speed);},layer_appearance_delay);break;case "slide-up":jQuery(layer).css({"left":parseInt(layer_left*scale,10)+"px","top":parseInt(2*viewport.height)+"px"});setTimeout(function(){jQuery(layer).animate({"top":parseInt(layer_top*scale,10)+"px"},layer_appearance_speed);},layer_appearance_delay);break;case "slide-left":jQuery(layer).css({"left":parseInt(2*viewport.width)+"px","top":parseInt(layer_top*scale,10)+"px"});setTimeout(function(){jQuery(layer).animate({"left":parseInt(layer_left*scale,10)+"px"},layer_appearance_speed);},layer_appearance_delay);break;case "slide-right":jQuery(layer).css({"left":"-"+parseInt(2*viewport.width)+"px","top":parseInt(layer_top*scale,10)+"px"});setTimeout(function(){jQuery(layer).animate({"left":parseInt(layer_left*scale,10)+"px"},layer_appearance_speed);},layer_appearance_delay);break;case "fade-in":jQuery(layer).css({"left":parseInt(layer_left*scale,10)+"px","top":parseInt(layer_top*scale,10)+"px","display":"none"});setTimeout(function(){jQuery(layer).fadeIn(layer_appearance_speed);},layer_appearance_delay);break;default:jQuery(layer).css({"left":parseInt(layer_left*scale,10)+"px","top":parseInt(layer_top*scale,10)+"px"});break;}});jQuery(this).show();});return false;}
function ulp_close(id){jQuery("#ulp-"+id).each(function(){ulp_subscribing=false;ulp_active_window_id=false;var layer_appearance_speed=500;var content=jQuery(this).find(".ulp-content");var viewport={width:Math.max(320,jQuery(window).width()),height:Math.max(320,jQuery(window).height())};jQuery("#ulp-"+id+"-overlay").unbind("click");jQuery(content).find(".ulp-layer").each(function(){var layer=this;var layer_appearance=jQuery(layer).attr("data-appearance");switch(layer_appearance){case "slide-down":jQuery(layer).animate({"top":"-"+parseInt(2*viewport.height)+"px"},layer_appearance_speed);break;case "slide-up":jQuery(layer).animate({"top":parseInt(2*viewport.height)+"px"},layer_appearance_speed);break;case "slide-left":jQuery(layer).animate({"left":parseInt(2*viewport.width)+"px"},layer_appearance_speed);break;case "slide-right":jQuery(layer).animate({"left":"-"+parseInt(2*viewport.width)+"px"},layer_appearance_speed);break;case "fade-in":jQuery(layer).fadeOut(layer_appearance_speed);break;default:jQuery(layer).css({"display":"none"});break;}
setTimeout(function(){var layer_content_encoded=jQuery(layer).attr("data-base64");if(layer_content_encoded){jQuery(layer).html(ulp_encode64(jQuery(layer).html()));}},layer_appearance_speed);});setTimeout(function(){jQuery("#ulp-"+id).hide();jQuery("#ulp-"+id+"-overlay").fadeOut(300);},layer_appearance_speed);});return false;}
function ulp_self_close(){ulp_close(ulp_active_window_id);return false;}
function ulp_subscribe(object){if(ulp_subscribing)return false;ulp_subscribing=true;jQuery(".ulp-input-error").removeClass("ulp-input-error");var button_label=jQuery("#ulp-"+ulp_active_window_id).find('.ulp-submit').html();var button_label_loading=jQuery("#ulp-"+ulp_active_window_id).find('.ulp-submit').attr("data-loading");if(!button_label_loading||button_label_loading=="")button_label_loading="Loading...";jQuery("#ulp-"+ulp_active_window_id).find('.ulp-submit').html(button_label_loading);jQuery.post(ulp_ajax_url,{"ulp-name":jQuery("#ulp-"+ulp_active_window_id).find('[name="ulp-name"]').val(),"ulp-email":jQuery("#ulp-"+ulp_active_window_id).find('[name="ulp-email"]').val(),"ulp-phone":jQuery("#ulp-"+ulp_active_window_id).find('[name="ulp-phone"]').val(),"ulp-message":jQuery("#ulp-"+ulp_active_window_id).find('[name="ulp-message"]').val(),"ulp-popup":ulp_active_window_id,"action":"ulp_subscribe"},function(return_data){var data;jQuery("#ulp-"+ulp_active_window_id).find('.ulp-submit').html(button_label);try{var data=jQuery.parseJSON(return_data);var status=data.status;if(status=="OK"){ulp_write_cookie("ulp-onload-"+ulp_active_window_id,ulp_cookie_value,180);ulp_write_cookie("ulp-onexit-"+ulp_active_window_id,ulp_cookie_value,180);_ulp_open(ulp_active_window_id,false);var close_delay=0;if(data.close_delay)close_delay=data.close_delay;var redirect_url=data.return_url;setTimeout(function(){if(redirect_url.length>0)location.href=redirect_url;else ulp_self_close();},close_delay);}else if(status=="ERROR"){ulp_subscribing=false;if(data.name=='ERROR')jQuery("#ulp-"+ulp_active_window_id).find('[name="ulp-name"]').addClass("ulp-input-error");if(data.email=='ERROR')jQuery("#ulp-"+ulp_active_window_id).find('[name="ulp-email"]').addClass("ulp-input-error");if(data.phone=='ERROR')jQuery("#ulp-"+ulp_active_window_id).find('[name="ulp-phone"]').addClass("ulp-input-error");if(data.message=='ERROR')jQuery("#ulp-"+ulp_active_window_id).find('[name="ulp-message"]').addClass("ulp-input-error");}else{ulp_subscribing=false;jQuery("#ulp-"+ulp_active_window_id).find('.ulp-submit').html("Error!");}}catch(error){ulp_subscribing=false;jQuery("#ulp-"+ulp_active_window_id).find('.ulp-submit').html("Error!");}});return false;}
function ulp_onload_open(onload_popup){if(!ulp_active_window_id){if(ulp_onload_mode=="once-session")ulp_write_cookie("ulp-onload-"+ulp_onload_popup,ulp_cookie_value,0);else if(ulp_onload_mode=="once-only")ulp_write_cookie("ulp-onload-"+ulp_onload_popup,ulp_cookie_value,180);ulp_open(onload_popup);if(ulp_onload_close_delay!=0){ulp_timeout=setTimeout(function(){ulp_self_close();},parseInt(ulp_onload_close_delay,10)*1000);}}}
function ulp_init(){var ulp_onload_cookie=ulp_read_cookie("ulp-onload-"+ulp_onload_popup);if(ulp_onload_popup!=""&&jQuery("#ulp-"+ulp_onload_popup).length!=0&&ulp_onload_mode!="none"&&ulp_onload_cookie!=ulp_cookie_value){if(parseInt(ulp_onload_delay,10)<=0){ulp_onload_open(ulp_onload_popup);}else{setTimeout(function(){ulp_onload_open(ulp_onload_popup);},parseInt(ulp_onload_delay,10)*1000);}}
var ulp_onexit_cookie=ulp_read_cookie("ulp-onexit-"+ulp_onexit_popup);if(ulp_onexit_popup!=""&&jQuery("#ulp-"+ulp_onexit_popup).length!=0&&ulp_onexit_mode!="none"&&ulp_onexit_cookie!=ulp_cookie_value){jQuery(document).bind('mouseleave',function(e){if(!ulp_active_window_id&&!ulp_onexit_displayed){if(ulp_onexit_mode=="once-session")ulp_write_cookie("ulp-onexit-"+ulp_onexit_popup,ulp_cookie_value,0);else if(ulp_onexit_mode=="once-only")ulp_write_cookie("ulp-onexit-"+ulp_onexit_popup,ulp_cookie_value,180);ulp_open(ulp_onexit_popup);ulp_onexit_displayed=true;}});}}
function ulp_read_cookie(key){var pairs=document.cookie.split("; ");for(var i=0,pair;pair=pairs[i]&&pairs[i].split("=");i++){if(pair[0]===key)return pair[1]||"";}
return null;}
function ulp_write_cookie(key,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}else var expires="";document.cookie=key+"="+value+expires+"; path=/";}
jQuery(window).resize(function(){if(ulp_active_window_id){var viewport={width:Math.max(320,jQuery(window).width()),height:Math.max(320,jQuery(window).height())};var width=parseInt(jQuery("#ulp-"+ulp_active_window_id).attr("data-width"),10);var height=parseInt(jQuery("#ulp-"+ulp_active_window_id).attr("data-height"),10);var scale=Math.min((viewport.width-20)/width,viewport.height/height);if(scale>1)scale=1;width=parseInt(width*scale,10);height=parseInt(height*scale,10);jQuery("#ulp-"+ulp_active_window_id).css({"width":width+"px","height":height+"px","margin-left":"-"+parseInt(width/2,10)+"px","margin-top":"-"+parseInt(height/2,10)+"px"});var content=jQuery("#ulp-"+ulp_active_window_id).find(".ulp-content");jQuery(content).css({"width":width+"px","height":height+"px",});jQuery(content).find(".ulp-layer").each(function(){var layer=this;var layer_left=jQuery(layer).attr("data-left");var layer_top=jQuery(layer).attr("data-top");var layer_width=jQuery(layer).attr("data-width");var layer_height=jQuery(layer).attr("data-height");var layer_font_size=jQuery(layer).attr("data-font-size");if(layer_width)jQuery(layer).css("width",parseInt(layer_width*scale,10)+"px");if(layer_height){jQuery(layer).css("height",parseInt(layer_height*scale,10)+"px");var layer_scrollbar=jQuery(layer).attr("data-scrollbar");if(layer_scrollbar&&layer_scrollbar=="on"){jQuery(layer).css("overflow","hidden");jQuery(layer).scrollTop(0);jQuery(layer).perfectScrollbar({suppressScrollX:true});}}
if(layer_font_size)jQuery(layer).css("font-size",Math.max(4,parseInt(layer_font_size*scale,10))+"px");jQuery(layer).css({"left":parseInt(layer_left*scale,10)+"px","top":parseInt(layer_top*scale,10)+"px"});});}});jQuery(document).ready(function(){jQuery(".ulp-window").each(function(){var ulp_id=jQuery(this).attr("id");ulp_id=ulp_id.replace("ulp-","");jQuery('[href="#'+ulp_id+'"]').click(function(){ulp_open(ulp_id);return false;});});});jQuery(document).keyup(function(e){if(ulp_active_window_id){if(jQuery("#ulp-"+ulp_active_window_id).attr("data-close")=="on"){if(e.keyCode==27)ulp_self_close();}}});function ulp_utf8encode(string){string=string.replace(/\x0d\x0a/g,"\x0a");var output="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){output+=String.fromCharCode(c);}else if((c>127)&&(c<2048)){output+=String.fromCharCode((c>>6)|192);output+=String.fromCharCode((c&63)|128);}else{output+=String.fromCharCode((c>>12)|224);output+=String.fromCharCode(((c>>6)&63)|128);output+=String.fromCharCode((c&63)|128);}}
return output;}
function ulp_encode64(input){var keyString="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=ulp_utf8encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+keyString.charAt(enc1)+keyString.charAt(enc2)+keyString.charAt(enc3)+keyString.charAt(enc4);}
return output;}
function ulp_utf8decode(input){var string="";var i=0;var c=c1=c2=0;while(i<input.length){c=input.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}else if((c>191)&&(c<224)){c2=input.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}else{c2=input.charCodeAt(i+1);c3=input.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}
return string;}
function ulp_decode64(input){var keyString="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=keyString.indexOf(input.charAt(i++));enc2=keyString.indexOf(input.charAt(i++));enc3=keyString.indexOf(input.charAt(i++));enc4=keyString.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}
if(enc4!=64){output=output+String.fromCharCode(chr3);}}
output=ulp_utf8decode(output);return output;}